<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    

    <title>createElement 隨手記</title>

     
    <link rel="stylesheet" href="https://nigel-wei-zhe.github.io/css/colors-dark.min.04ff1d6d2078fa65747fb72cef57eee0015c1b56e56c24eed85082032b2182f4.css" />
    <link rel="stylesheet" href="https://nigel-wei-zhe.github.io/css/mystyle.min.b714d93137a57ef2061e952e17d9d0c9bba8139d60a5ea4752530352bb90b2f0.css" />

    
  </head>
  <body>
    <header id="header">
      <h1><a href="https://nigel-wei-zhe.github.io/">Nigel 隨便寫</a></h1>
      <p>唯一應該超越的人，是昨天的自己</p>
      <p>The only person you should try to be better than, is who you were yesterday.</p>
    </header>

    <div id="page">
      <div id="sidebar"><nav>
	
		<ul class="nav">
			
				<li>
					<a href="/about">
						<div class="nav-item">
							<span>About Me</span>
							<span class="identifier">關於我</span>
						</div>
					</a>
				</li>
			
				<li>
					<a href="/posts">
						<div class="nav-item">
							<span>Blog</span>
							<span class="identifier">網誌</span>
						</div>
					</a>
				</li>
			
		</ul>
	
</nav>
</div>

      <div id="content">
<article class="post">
  <h1>
    <a href="https://nigel-wei-zhe.github.io/posts/createelement/">createElement 隨手記</a> 
  </h1>

  <div class="post-content"><h2 id="關於-createelement">關於 createElement</h2>
<h3 id="documentcreateelement">Document.createElement()</h3>
<blockquote>
<p>創造一個元素,搭配其他 api 可以實現在指定的元素後,把創造出來的新元素添加上去</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">const</span> title = <span style="color:#fff;font-weight:bold">document</span>.createElement(<span style="color:#0ff;font-weight:bold">&#34;div&#34;</span>);
</span></span><span style="display:flex;"><span>title.innerText = <span style="color:#0ff;font-weight:bold">&#34;Hello world&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">document</span>.getElementsByTagName(<span style="color:#0ff;font-weight:bold">&#34;body&#34;</span>)[<span style="color:#ff0;font-weight:bold">0</span>].appendChild(title);
</span></span></code></pre></div><h3 id="vue-createelement">vue createElement()</h3>
<blockquote>
<p>vue 製作 Virtual DOM 的函式,透過 render function 呼叫 createElement 來創造,
內部含有實現進行 diff 算法比較新舊 Virtual DOM 的差異,進而觸發渲染</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span>Vue.component(<span style="color:#0ff;font-weight:bold">&#34;hello-world&#34;</span>, {
</span></span><span style="display:flex;"><span>  render(createElement) {
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> createElement(<span style="color:#0ff;font-weight:bold">&#34;h1&#34;</span>, {
</span></span><span style="display:flex;"><span>      domProps: {
</span></span><span style="display:flex;"><span>        innerHTML: <span style="color:#0ff;font-weight:bold">&#34;Hello world&#34;</span>,
</span></span><span style="display:flex;"><span>      },
</span></span><span style="display:flex;"><span>    });
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>});
</span></span></code></pre></div><hr>
<h3 id="vue-createelement-應用">vue createElement() 應用</h3>
<blockquote>
<p>參數相關設定可以直接參考 <a href="https://cn.vuejs.org/v2/guide/render-function.html#createElement-%E5%8F%82%E6%95%B0">官網</a>。
直接舉個使用經驗,今天有一個需求是需要基於 vue 提供的 transition 的标签名進行加工
目的是想透過 transition 本身針對 enter 跟 leave 的相關事件,來實作收合</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">const</span> transitionStyle = <span style="color:#0ff;font-weight:bold">&#34;0.3s height ease-in-out&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">const</span> Transition = {
</span></span><span style="display:flex;"><span>  beforeEnter(el) {
</span></span><span style="display:flex;"><span>    el.style.transition = transitionStyle;
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">if</span> (!el.dataset) el.dataset = {};
</span></span><span style="display:flex;"><span>    el.style.height = <span style="color:#ff0;font-weight:bold">0</span>;
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  enter(el) {
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">if</span> (el.scrollHeight !== <span style="color:#ff0;font-weight:bold">0</span>) {
</span></span><span style="display:flex;"><span>      el.style.height = <span style="color:#0ff;font-weight:bold">`</span><span style="color:#0ff;font-weight:bold">${</span>el.scrollHeight<span style="color:#0ff;font-weight:bold">}</span><span style="color:#0ff;font-weight:bold">px`</span>;
</span></span><span style="display:flex;"><span>    } <span style="color:#fff;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>      el.style.height = <span style="color:#0ff;font-weight:bold">&#34;&#34;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    el.style.overflow = <span style="color:#0ff;font-weight:bold">&#34;hidden&#34;</span>;
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  afterEnter(el) {
</span></span><span style="display:flex;"><span>    el.style.transition = <span style="color:#0ff;font-weight:bold">&#34;&#34;</span>;
</span></span><span style="display:flex;"><span>    el.style.height = <span style="color:#0ff;font-weight:bold">&#34;&#34;</span>;
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  beforeLeave(el) {
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">if</span> (!el.dataset) el.dataset = {};
</span></span><span style="display:flex;"><span>    el.style.height = <span style="color:#0ff;font-weight:bold">`</span><span style="color:#0ff;font-weight:bold">${</span>el.scrollHeight<span style="color:#0ff;font-weight:bold">}</span><span style="color:#0ff;font-weight:bold">px`</span>;
</span></span><span style="display:flex;"><span>    el.style.overflow = <span style="color:#0ff;font-weight:bold">&#34;hidden&#34;</span>;
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  leave(el) {
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">if</span> (el.scrollHeight !== <span style="color:#ff0;font-weight:bold">0</span>) {
</span></span><span style="display:flex;"><span>      el.style.transition = transitionStyle;
</span></span><span style="display:flex;"><span>      el.style.height = <span style="color:#ff0;font-weight:bold">0</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  afterLeave(el) {
</span></span><span style="display:flex;"><span>    el.style.transition = <span style="color:#0ff;font-weight:bold">&#34;&#34;</span>;
</span></span><span style="display:flex;"><span>    el.style.height = <span style="color:#0ff;font-weight:bold">&#34;&#34;</span>;
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#fff;font-weight:bold">export</span> <span style="color:#fff;font-weight:bold">default</span> {
</span></span><span style="display:flex;"><span>  name: <span style="color:#0ff;font-weight:bold">&#34;CollapseTransition&#34;</span>,
</span></span><span style="display:flex;"><span>  functional: <span style="color:#fff;font-weight:bold">true</span>,
</span></span><span style="display:flex;"><span>  render(h, { children }) {
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">const</span> data = {
</span></span><span style="display:flex;"><span>      on: Transition,
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>    <span style="color:#fff;font-weight:bold">return</span> h(<span style="color:#0ff;font-weight:bold">&#34;transition&#34;</span>, data, children);
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#007f7f">// 備註:
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">// 事件监听器在 `on` 内，
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">// 但不再支持如 `v-on:keyup.enter` 这样的修饰器。
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">// 需要在处理函数中手动检查 keyCode。
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">//  on: {
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">//    click: this.clickHandler
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">//  },
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f"></span>
</span></span><span style="display:flex;"><span><span style="color:#007f7f">// render(h, { children })  的第二個參數
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">// slots() 和 children 对比 參考官網
</span></span></span><span style="display:flex;"><span><span style="color:#007f7f">// https://cn.vuejs.org/v2/guide/render-function.html#slots-%E5%92%8C-children-%E5%AF%B9%E6%AF%94
</span></span></span></code></pre></div><hr>
<h2 id="參考資料">參考資料</h2>
<p><a href="https://developer.mozilla.org/zh-TW/docs/Web/API/Document/createElement">MDN-Document.createElement</a><!-- raw HTML omitted -->
<a href="https://cn.vuejs.org/v2/guide/render-function.html">VUE-渲染函数 &amp; JSX</a><!-- raw HTML omitted -->
<a href="https://www.jianshu.com/p/42a3ec621e94">React 拾遗：React.createElement 与 JSX</a><!-- raw HTML omitted -->
<a href="https://www.mdeditor.tw/pl/pZdO/zh-tw">學會使用 Vue JSX，一車老乾媽都是你的</a><!-- raw HTML omitted -->
<a href="https://juejin.cn/post/6867458052036624392">Vue 函数式组件</a><!-- raw HTML omitted -->
<a href="https://medium.com/@leo36094/vue-render-function-%E5%BB%BA%E6%A7%8B%E4%B8%80%E5%BD%88%E6%80%A7%E9%AB%98-%E6%98%93%E5%B0%81%E8%A3%9D%E7%9A%84%E7%9A%84-component-%E5%90%A7-bdb2bdee46f1">Vue Render Function 到 Functional Component — 建構一彈性高、易封裝的 UI Component 吧</a></p>
</div>

  <p class="meta">
    Posted on
    <span class="postdate">15. May 2021</span>
  </p>
</article>
</div>

      <footer id="footer">
        <p class="copyright">
           Copyright © 2022 nigel-lee. All rights reserved. 
        </p>
      </footer>
    </div>

    
  </body>
</html>
